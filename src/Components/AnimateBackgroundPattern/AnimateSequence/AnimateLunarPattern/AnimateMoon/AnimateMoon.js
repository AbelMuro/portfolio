import React, {useContext, useState} from 'react';
import { ContainerContext } from '!/AnimateBackgroundPattern';
import { motion, useScroll, useTransform, useSpring, useMotionValueEvent, AnimatePresence, useMotionTemplate} from 'framer-motion';
import * as styles from './styles.module.css';

/* 
    this is where i left off, im still deliberating if i should fade out the black pattern on the moon or keep it
    i also want to 'zoom' into the moon design and i can finally start displaying my projects
*/


function AnimateMoon() {
    const [mount, setMount] = useState(false);
    const {MainContainerRef} = useContext(ContainerContext);
    const {scrollY} = useScroll(MainContainerRef);
    
    const z = useTransform(scrollY, [8500, 9000], [0, 15]);
    const smoothZ = useSpring(z, {stiffness: 150, damping: 80});
    const translateZBack = useTransform(scrollY, [12800, 13000], [15, 0]);

    const opacity = useTransform(scrollY, [9500, 10000], [0, 1])
    const opacitySmooth = useSpring(opacity, {stiffness: 150, damping: 80});

    const scale = useTransform(scrollY, [14000, 14500], [1, 15]);
    const smoothScale = useSpring(scale, {stiffness: 150, damping: 80});

    const strokeDashoffset = useTransform(scrollY, [15000, 15500], [6.841858386993408, 0])
    const smoothDashoffset = useSpring(strokeDashoffset, {stiffness: 150, damping: 80});

    const strokeWidth = useTransform(scrollY, [16000, 16001], [0.003, 0]);
    const smoothStrokeWidth = useSpring(strokeWidth, {stiffness: 150, damping: 80})

    const fill = useTransform(scrollY, [15500, 16000], ['#00000000', '#000000']);

    const transformContainer = useMotionTemplate`translateZ(${smoothZ}px)`;
    const transformMoon = useMotionTemplate`translate(-34.5px, 2.9px) scale(${smoothScale})`;
    const transformLunarPattern = useMotionTemplate`translate(-34.65px, 2.9px) scale(${smoothScale})`;


    useMotionValueEvent(translateZBack, 'change', (value) => {
        smoothZ.set(value);
    })


    return(
        <motion.div id='moon' className={styles.container} style={{transform: transformContainer}} exit={{opacity: 0}}>
                <motion.svg viewBox={"0 0 206.40488 206.40488"} className={styles.svg}>
                    <defs>
                        <filter id='glowEffect'>
                            <feGaussianBlur in="SourceAlpha" stdDeviation="2" result="blur">
                                <animate attributeName="stdDeviation" values="2;0;2" dur="3s" repeatCount="indefinite" calcMode="linear"/>
                            </feGaussianBlur>
                            <feFlood floodColor="#0400ff" floodOpacity='0.5' result="color"/>
                            <feComposite in="color" in2="blur" operator="in" result="glow"/>
                            <feMerge>
                                <feMergeNode in="glow"/>
                                <feMergeNode in="SourceGraphic"/>
                            </feMerge>
                        </filter>
                    </defs>
                    <motion.g style={{opacity: opacitySmooth, transform: transformMoon}}>
                        <path
                            id="path4"
                            filter={'url(#glowEffect)'}
                            fill="#0400ff"
                            fillOpacity={1}
                            stroke="#0400ff"
                            strokeWidth={0}
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            strokeMiterlimit={0}
                            strokeDasharray="none"
                            strokeOpacity={1}
                            d="m 137.86313,98.771578 c 0,0.17396 -0.14103,0.31499 -0.31501,0.31499 -0.17396,0 -0.31499,-0.14103 -0.31499,-0.31499 0,-0.17398 0.14103,-0.31501 0.31499,-0.31501 0.0425,0 -0.12204,0.0416 -0.17326,0.15087 -0.0428,0.0912 -0.0416,0.18995 0.0457,0.27235 0.10267,0.0968 0.23663,0.0903 0.32283,0.0372 0.0968,-0.0597 0.11973,-0.19615 0.11973,-0.14539 z"
                            />
                    </motion.g>
                    <motion.g id='lunar pattern' style={{transform: transformLunarPattern}} className={styles.lunarPattern}>
                            <motion.path
                                fill={fill}
                                style={{strokeDashoffset: smoothDashoffset}}
                                strokeDasharray={6.841858386993408}
                                stroke='#000000'
                                strokeWidth={smoothStrokeWidth}
                                d="m 137.4186,98.485572 c 5e-4,0.0033 9.9e-4,0.0065 0.003,0.0098 10e-4,0.0057 10e-4,0.01143 0.003,0.01707 5.1e-4,0.0091 -5.2e-4,0.01826 -0.003,0.02728 -5e-4,0.004 -9.8e-4,0.0078 -0.003,0.01199 9.9e-4,-0.0011 0.003,-0.0028 0.004,-0.0042 0.003,-0.0032 0.007,-0.0063 0.0102,-0.0093 9.8e-4,-0.0016 0.006,-0.0037 0.006,-0.0059 5.2e-4,-0.0016 1.2e-4,-0.0039 2e-5,-0.0056 -2.3e-4,-0.0026 -1.2e-4,-0.0054 -5.2e-4,-0.008 -9.9e-4,-0.01284 -0.004,-0.02625 -0.0102,-0.03767 l -0.0102,0.0044 m -0.004,0.0021 c -9.7e-4,9.06e-4 -0.006,0.0017 -0.006,0.0033 -5.1e-4,0.0011 2.1e-4,0.0046 2.1e-4,0.006 0,0.0053 -2e-5,0.0103 -5.2e-4,0.0155 -9.9e-4,0.01621 -0.007,0.03193 -0.0149,0.04631 -0.015,0.02759 -0.0381,0.05062 -0.0655,0.06595 -0.007,0.0037 -0.0127,0.0068 -0.0199,0.0098 -0.004,0.0017 -0.009,0.0029 -0.0127,0.005 v 2.26e-4 c 0.0102,0.0068 0.0202,0.01045 0.0322,0.01045 0.004,-2e-5 0.009,-6.55e-4 0.0113,-0.0016 9.9e-4,-4.73e-4 0.003,-0.0016 0.004,2.2e-5 -0.003,8.54e-4 -0.004,0.0026 -0.006,0.0042 -0.004,0.0025 -0.007,0.005 -0.0113,0.0068 -0.0102,0.0046 -0.0207,0.006 -0.031,0.0063 -0.0102,4.73e-4 -0.0194,-5.54e-4 -0.0293,-5.54e-4 -9.9e-4,0 -0.004,-2.2e-5 -0.007,-2.25e-4 -5.2e-4,-9.2e-5 -0.003,-5.54e-4 -0.003,4.3e-5 -4.9e-4,5.54e-4 -9.9e-4,0.0023 -9.9e-4,0.0034 -9.7e-4,0.0029 -9.7e-4,0.0059 -0.003,0.0088 -0.003,0.0078 -0.004,0.01587 -0.007,0.02393 -9.9e-4,0.0043 -0.003,0.0088 -0.003,0.01312 0.004,-9.84e-4 0.009,-0.0011 0.0127,-0.002 0.0102,-0.0019 0.019,-0.0046 0.0282,-0.008 0.0192,-0.0074 0.0368,-0.01841 0.0518,-0.03243 0.007,-0.0063 0.0127,-0.01383 0.0186,-0.02078 0.006,-0.0065 0.0113,-0.01327 0.0164,-0.0204 9.9e-4,-0.0017 9.9e-4,-0.0039 0.003,-0.0057 9.8e-4,-0.0037 0.003,-0.0071 0.004,-0.01072 0.004,-0.0098 0.0102,-0.01931 0.0153,-0.02825 0.003,-0.005 0.007,-0.01 0.0102,-0.01451 9.8e-4,-0.0023 0.004,-0.0049 0.006,-0.0074 0.003,-0.0044 0.004,-0.01045 0.006,-0.0153 0.004,-0.01383 0.006,-0.02789 0.006,-0.04217 -5e-4,-0.0046 -5e-4,-0.0088 -9.8e-4,-0.0134 -5e-4,-0.0017 -5e-4,-0.0039 -9.8e-4,-0.0054 m -0.0533,0.164416 c -9.7e-4,0.0032 -0.004,0.0059 -0.007,0.0081 -0.004,0.0054 -0.0102,0.01045 -0.0148,0.0155 -0.0196,0.01972 -0.0408,0.03781 -0.0649,0.05207 -0.009,0.0047 -0.0174,0.0074 -0.0261,0.01 -0.003,7.54e-4 -0.006,0.0014 -0.009,0.002 -5e-4,2.27e-4 -0.003,2.27e-4 -0.003,8.56e-4 -5e-4,5.53e-4 -5e-4,0.0014 -5e-4,0.0021 -1.9e-4,0.002 -4.9e-4,0.0039 -4.9e-4,0.0057 0.0113,-0.0028 0.0228,-0.0049 0.0336,-0.0088 0.0267,-0.01006 0.0499,-0.02713 0.07,-0.04719 -9.9e-4,0.0039 -0.004,0.0074 -0.006,0.01115 -9.9e-4,0.0021 -9.9e-4,0.0047 -0.003,0.0064 -0.003,0.0026 -0.006,0.005 -0.009,0.0071 -0.006,0.0049 -0.0113,0.0095 -0.0177,0.01383 -0.0161,0.01157 -0.0329,0.02159 -0.0516,0.02864 -0.006,0.0022 -0.0113,0.0046 -0.0181,0.006 l -2.1e-4,0.01115 c 0.0113,-0.0026 0.0229,-0.008 0.0335,-0.01284 0.0186,-0.0084 0.0374,-0.0179 0.0519,-0.03242 -9.8e-4,0.0037 -0.003,0.0056 -0.006,0.0081 -0.003,0.0028 -0.006,0.0059 -0.007,0.0088 -0.0113,0.01355 -0.0201,0.03074 -0.036,0.03937 -0.009,0.0044 -0.0171,0.0067 -0.0257,0.0095 -0.003,6.53e-4 -0.004,0.0014 -0.007,0.0021 -5.1e-4,2.27e-4 -9.9e-4,3.32e-4 -0.003,0.0011 -4.9e-4,9.86e-4 10e-5,0.0029 2e-4,0.0042 5.1e-4,0.0036 5.1e-4,0.007 9.9e-4,0.01059 9.8e-4,0.0085 0.003,0.01719 0.004,0.0257 9.8e-4,0.0052 0.003,0.01016 0.003,0.0153 0.006,-1.4e-5 0.0127,-0.0012 0.0181,-0.0032 -4.9e-4,0.007 -0.003,0.01446 -0.006,0.02099 -5e-4,0.0021 -9.9e-4,0.0042 -0.003,0.0062 -5e-4,8.03e-4 -9.8e-4,0.0021 -9.8e-4,0.0032 2e-4,0.0019 9.8e-4,0.0042 9.8e-4,0.006 9.9e-4,0.0043 0.003,0.0084 0.006,0.01256 0.007,0.01527 0.0147,0.02987 0.0237,0.04396 0.0329,0.05197 0.0822,0.09362 0.13855,0.118485 0.0127,0.0056 0.0255,0.0103 0.0388,0.01423 0.006,0.0016 0.0113,0.0039 0.0163,0.0043 v -3.64e-4 c -0.009,-0.0043 -0.0159,-0.0085 -0.0244,-0.01185 -0.0102,-0.0042 -0.0217,-0.0067 -0.0317,-0.01172 -0.0212,-0.0103 -0.0421,-0.02224 -0.0613,-0.03621 -0.0102,-0.007 -0.0193,-0.01461 -0.0277,-0.02317 -0.0205,-0.02113 -0.0359,-0.04818 -0.0434,-0.07672 -0.003,-0.01312 -0.006,-0.02682 -0.006,-0.04041 -4.9e-4,-0.0071 -2e-5,-0.01451 -2e-5,-0.02177 h 2.2e-4 c 0,0.01768 9.8e-4,0.0351 0.007,0.05219 0.007,0.02705 0.0229,0.05287 0.0424,0.0732 0.009,0.0088 0.018,0.01624 0.0275,0.02374 0.0141,0.01072 0.0279,0.02075 0.0437,0.02879 0.0141,0.0068 0.0278,0.01172 0.0422,0.01648 0.0322,0.01059 0.0661,0.01714 0.0999,0.0195 0.009,5.02e-4 0.017,-2.08e-4 0.0251,-2.08e-4 v -2.08e-4 c -0.006,0 -0.0127,-9.85e-4 -0.0187,-0.0016 -0.0127,-0.0016 -0.0254,-0.0039 -0.0381,-0.0065 -0.0169,-0.0037 -0.0338,-0.0083 -0.0498,-0.01487 -0.007,-0.0029 -0.0146,-0.0074 -0.0217,-0.01129 -0.0141,-0.007 -0.0272,-0.01441 -0.0397,-0.02357 -0.0356,-0.02623 -0.0645,-0.0641 -0.0741,-0.107735 -0.003,-0.01397 -0.004,-0.02851 -0.003,-0.04277 9.9e-4,-0.02365 0.006,-0.04741 0.0141,-0.06985 0.003,-0.0083 0.006,-0.01666 0.009,-0.02492 9.9e-4,-0.0036 0.003,-0.0072 0.004,-0.01099 5.1e-4,-0.002 -5e-4,-0.0049 -5e-4,-0.0065 -5.1e-4,-0.0047 -9.9e-4,-0.0093 -9.9e-4,-0.01397 -9.8e-4,-0.01256 -5.1e-4,-0.02551 5e-4,-0.03805 9.9e-4,-0.01199 0.004,-0.02359 0.006,-0.03532 5.1e-4,-0.0033 9.8e-4,-0.0064 0.003,-0.0096 5.1e-4,-0.0012 9.8e-4,-0.0028 5.1e-4,-0.0042 m -0.0207,0.04002 -2e-4,2.25e-4 2e-4,-2.25e-4 m -0.0192,0.03924 -2.1e-4,2.27e-4 2.1e-4,-2.27e-4 m 0.0357,0.04236 c -0.003,0.0065 -0.003,0.01439 -0.006,0.02139 -9.8e-4,0.01086 -0.003,0.02193 -0.003,0.03297 -9.8e-4,0.03147 0.003,0.06298 0.0176,0.09124 0.0154,0.0293 0.0402,0.0515 0.0673,0.06991 0.0163,0.011 0.0331,0.02153 0.0508,0.0301 0.0255,0.01242 0.0521,0.02199 0.0791,0.03078 0.0127,0.0042 0.025,0.0078 0.0375,0.01199 0.007,0.0025 0.0155,0.0059 0.0233,0.0075 v 2.07e-4 c -0.006,4.6e-5 -0.0102,5.02e-4 -0.015,-5.04e-4 -0.0127,-0.0019 -0.0235,-0.0067 -0.0352,-0.01006 -0.003,-7.54e-4 -0.006,-0.0013 -0.009,-0.0019 -0.0113,-0.0036 -0.0236,-0.0081 -0.0353,-0.01226 -0.0158,-0.0056 -0.0317,-0.01086 -0.0473,-0.0175 -0.0127,-0.0054 -0.0245,-0.01142 -0.0362,-0.01867 -0.003,-0.0019 -0.006,-0.0039 -0.009,-0.0059 -9.9e-4,-0.0013 -0.003,-0.0026 -0.006,-0.0022 9.9e-4,0.0034 0.006,0.0063 0.009,0.0084 0.007,0.0056 0.0157,0.01 0.0236,0.01487 0.026,0.01648 0.0548,0.0281 0.0835,0.03838 0.007,0.0026 0.0148,0.0054 0.0223,0.008 0.003,0.0013 0.007,0.0032 0.0102,0.0036 v 2.07e-4 h -9.9e-4 v 2.08e-4 c 0.004,0 0.009,0.0013 0.0113,9.85e-4 0.007,-5.04e-4 0.0141,-0.0029 0.0209,-0.0016 0.004,7.56e-4 0.009,0.0025 0.0127,0.0046 9.8e-4,7.54e-4 0.004,0.0029 0.006,0.0026 0.004,-5.02e-4 0.009,-0.0022 0.0127,-0.0036 0.009,-0.0025 0.0171,-0.0056 0.0254,-0.0087 0.0359,-0.01383 0.0695,-0.03486 0.0978,-0.06097 0.009,-0.0081 0.0174,-0.0166 0.0251,-0.02572 9.8e-4,-0.0022 0.004,-0.0047 0.006,-0.007 5.2e-4,-9.85e-4 9.9e-4,-0.0022 0.003,-0.0036 9.9e-4,-0.005 0.003,-0.01086 0.003,-0.0161 9.9e-4,-0.01567 1e-4,-0.03183 -0.006,-0.04669 -0.003,-0.0071 -0.007,-0.01353 -0.0102,-0.0204 -0.004,0.0026 -0.007,0.0067 -0.0102,0.01 -9.8e-4,8.05e-4 -0.003,0.0023 -0.004,0.0039 -1.3e-4,8.04e-4 4.8e-4,0.0019 4.8e-4,0.0025 5e-4,0.0017 0.001,0.0034 0.001,0.0052 9.9e-4,0.0056 0.003,0.011 0.003,0.01668 9.8e-4,0.01817 -0.003,0.03624 -0.0113,0.05238 -0.0127,0.02425 -0.0343,0.04331 -0.0573,0.05709 -0.006,0.0033 -0.0113,0.0062 -0.0167,0.0084 -0.004,0.0016 -0.007,0.0032 -0.0113,0.0034 -0.009,5.04e-4 -0.0163,-0.0037 -0.0241,-0.0053 -9.9e-4,-5.04e-4 -0.004,1.16e-4 -0.007,-2.03e-4 -0.007,-0.0013 -0.0127,-0.0034 -0.0192,-0.005 -0.0113,-0.0029 -0.0223,-0.0059 -0.0332,-0.0084 -0.009,-0.0021 -0.0171,-0.005 -0.0257,-0.006 v 2.04e-4 l 0.0267,0.0077 0.0468,0.01369 0.0247,0.0071 v 2.07e-4 c -0.0127,9.84e-4 -0.0231,-0.0022 -0.0346,-0.006 -0.0153,-0.0049 -0.0304,-0.0103 -0.0456,-0.01526 -0.0264,-0.0084 -0.0528,-0.01671 -0.0784,-0.02743 -0.0204,-0.0085 -0.0402,-0.01873 -0.0593,-0.02987 -0.0297,-0.01721 -0.0576,-0.03852 -0.0738,-0.06973 -0.0113,-0.02217 -0.0163,-0.04571 -0.0174,-0.07044 -4.8e-4,-0.0072 1.2e-4,-0.01488 5.1e-4,-0.02217 5.1e-4,-0.0037 9.9e-4,-0.008 9.9e-4,-0.01172 -2.1e-4,-0.0029 -0.003,-0.0063 -0.003,-0.009 -9.9e-4,-0.0036 -0.003,-0.007 -0.003,-0.01058 -5.1e-4,-0.0021 -5.1e-4,-0.0046 -9.8e-4,-0.0064 m 0.0316,0.06769 c 5.2e-4,0.01535 0.006,0.03133 0.0102,0.04573 0.004,0.01226 0.0102,0.02407 0.017,0.03512 0.0295,0.04728 0.0793,0.07705 0.13194,0.09171 0.009,0.0022 0.0171,0.0054 0.0258,0.0068 0.0143,0.0025 0.0284,0.0026 0.0428,0.0033 0.009,5.03e-4 0.0171,0.0021 0.0257,0.0016 0.0166,-5.05e-4 0.0325,-0.0042 0.0484,-0.0088 0.0102,-0.0029 0.0192,-0.0059 0.0281,-0.01059 0.0184,-0.01 0.0366,-0.02528 0.0421,-0.04625 0.003,-0.01059 0.001,-0.02189 -0.003,-0.0318 -9.8e-4,-0.0022 -0.003,-0.0044 -0.004,-0.0064 -5.1e-4,-6.04e-4 -9.9e-4,-0.0019 -9.9e-4,-0.0021 -4.9e-4,-4.06e-4 -0.003,9.84e-4 -0.003,0.0014 -0.003,0.0017 -0.006,0.0036 -0.009,0.0047 4.9e-4,0.0023 0.003,0.0049 0.006,0.007 0.004,0.006 0.006,0.01213 0.006,0.01924 -7e-5,0.0036 -9.8e-4,0.0068 -0.003,0.01045 -0.006,0.01878 -0.0186,0.03262 -0.036,0.0404 -0.0332,0.01471 -0.0724,0.01461 -0.10767,0.0093 -0.0297,-0.0044 -0.0575,-0.01383 -0.0844,-0.02679 -0.007,-0.0037 -0.0157,-0.0073 -0.0232,-0.01172 -0.0215,-0.01284 -0.0417,-0.03027 -0.057,-0.04995 -0.009,-0.01016 -0.015,-0.02108 -0.0202,-0.03277 -9.7e-4,-0.0044 -0.004,-0.0087 -0.006,-0.0134 -5.1e-4,-0.0022 -9.9e-4,-0.0052 -0.003,-0.007 -9.9e-4,-0.0019 -0.003,-0.0034 -0.004,-0.005 -0.003,-0.0028 -0.006,-0.0057 -0.007,-0.0085 -0.003,-0.0034 -0.006,-0.007 -0.009,-0.01059 -9.7e-4,-0.0017 -0.003,-0.0037 -0.004,-0.0054 m -0.10301,0.01588 v 0.0029 h -2e-4 l 2e-4,-0.0029 m 0.1332,0.02002 c 0.003,0.0078 0.007,0.01539 0.0127,0.02256 0.0276,0.04351 0.0727,0.07005 0.1205,0.08601 0.0141,0.0047 0.0287,0.0084 0.0434,0.01059 0.006,7.55e-4 0.0113,0.0021 0.0177,0.0021 V 98.9981 c -0.007,-0.0044 -0.0141,-0.0096 -0.0204,-0.01439 -0.004,-0.0029 -0.0102,-0.0057 -0.0127,-0.0091 -0.004,-0.0047 -0.009,-0.0103 -0.0127,-0.01525 -9.8e-4,-0.0016 -0.003,-0.0039 -0.004,-0.0053 -9.9e-4,-0.0016 -0.006,-0.0016 -0.009,-0.0021 -0.007,-0.0016 -0.0127,-0.0032 -0.0195,-0.0053 -0.0127,-0.004 -0.0247,-0.0085 -0.0365,-0.01432 -0.004,-0.0019 -0.007,-0.0037 -0.0113,-0.0059 -0.003,-0.0017 -0.006,-0.0039 -0.0102,-0.0044 v -2.07e-4 l 9.8e-4,-2.07e-4 v -2.05e-4 c -0.006,-0.0022 -0.0102,-0.0059 -0.0141,-0.0088 -0.0113,-0.0071 -0.021,-0.01522 -0.0308,-0.0238 -0.004,-0.0039 -0.009,-0.0087 -0.0127,-0.01213 m 0.19424,0.121449 v 2.08e-4 l 0.003,0.0025 c -5.2e-4,-0.0016 -9.9e-4,-0.0028 -0.003,-0.0028 m -0.0395,0.02432 v 2.09e-4 h 5.1e-4 l -5.1e-4,-2.09e-4 m -1.9e-4,0.05121 v 2.07e-4 h 9.8e-4 l -9.8e-4,-2.07e-4 m 0.004,2.07e-4 v 2.04e-4 h 9.8e-4 z"
                                id="path496" />
                    </motion.g>
                </motion.svg>
        </motion.div>
    )
}

export default AnimateMoon;